<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GraphQL Testing</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
</head>
<body>

    <!-- <div class="w-100 d-flex justify-content-center">
        <form class="w-50 mt-5" id="form">
            <div class="mb-3">
                <label for="name" class="form-label">Product Name</label>
                <input type="text" class="form-control" id="name">
            </div>
            <div class="mb-3">
                <label for="price" class="form-label">Price</label>
                <input type="text" class="form-control" id="price">
            </div>
            <div class="mb-3">
                <label for="desc" class="form-label">Description</label>
                <input type="text" class="form-control" id="desc">
            </div>
            <div class="mb-3">
                <label for="image" class="form-label">Password</label>
                <input type="file" accept=".png,.jpeg,.jpg" class="form-control" id="image">
            </div>
            <button type="submit" class="btn btn-primary">Submit</button>
        </form>
    </div> -->

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>

    <script>

        const form = document.getElementById('form');

        form.addEventListener('submit', async function (event) {
            event.preventDefault();

            try {
                const name = document.getElementById('name').value;
                const price = Number(document.getElementById('price').value);
                const desc = document.getElementById('desc').value;
                const image = document.getElementById('image').files[0];

                const variables = {
                    name: name,
                    price: price,
                    description: desc,
                    createdDate : new Date(Date.now())
                    // thumbnail: image,
                }

                // const query = `
                //     mutation AddProduct($name : String!, $price : Int! , $description : String! , $thumbnail : Upload!){
                //         addProduct(name : $name , price : $price , description : $description , thumbnail : $thumbnail){
                //             name,
                //             price,
                //             id,
                //             description  
                //             thumbnail  
                //         }
                //     }
                // `

                 const query = `
                    mutation AddProduct($name : String!, $price : Int! , $description : String! , $createdDate : Date!){
                        addProduct(name : $name , price : $price , description : $description , createdDate : $createdDate){
                            name,
                            price,
                            id,
                            description  
                            createdDate 
                        }
                    }
                `

                const response = await fetch('http://127.0.0.1:8000/graphql', {
                    method: 'POST',
                    headers: {
                        'Content-Type': "application/json",
                        'Accept': "application/json"
                    },
                    body: JSON.stringify({
                        query,
                        variables,
                    })
                })

                const {data , errors} = await response.json();

                if(data){
                    const {addProduct} = data;
                    console.log("Successfully")
                    console.log(addProduct);
                }else{
                    console.log("Unsuccessfully");
                    console.log(errors)

                }
            } catch (error) {
                console.log(error.message);
            }
        })

    </script>
</body>

</html>